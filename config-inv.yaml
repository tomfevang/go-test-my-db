tables:
  AccountAnomalyInv:
    columns:
      accountCheckId: '{{Number 1 100000}}'
      date: '{{printf "%04d-%02d-%02d" (Number 2020 2025) (Number 1 12) (Number 1 28)}}'
      message: '{{HackerPhrase}}'

  AnomalySeverity:
    columns:
      anomalyId: '{{Number 1 100000}}'
      severity: '{{RandomString (SliceString "LOW" "MEDIUM" "HIGH" "CRITICAL")}}'

  AnomalyStatus:
    columns:
      anomalyId: '{{Number 1 100000}}'
      status: '{{RandomString (SliceString "OPEN" "INVESTIGATING" "RESOLVED" "DISMISSED")}}'

  AnomalyAmount:
    columns:
      anomalyId: '{{Number 1 100000}}'
      amount: '{{Number 0 100}}'

tests:
  # --- 1 WHERE condition (1 JOIN) ---
  - name: "1 cond: severity (1 JOIN)"
    query: "SELECT a.id, s.severity, a.date FROM AccountAnomalyInv a JOIN AnomalySeverity s ON s.anomalyId = a.id WHERE s.severity = 'CRITICAL'"
    repeat: 500

  # --- 2 WHERE conditions (1 JOIN) ---
  - name: "2 cond: severity + date (1 JOIN)"
    query: "SELECT a.id, s.severity, a.date FROM AccountAnomalyInv a JOIN AnomalySeverity s ON s.anomalyId = a.id WHERE s.severity = 'HIGH' AND a.date >= '2023-01-01'"
    repeat: 500

  # --- 3 WHERE conditions (2 JOINs) ---
  - name: "3 cond: severity + status + date (2 JOINs)"
    query: "SELECT a.id, s.severity, st.status, a.date FROM AccountAnomalyInv a JOIN AnomalySeverity s ON s.anomalyId = a.id JOIN AnomalyStatus st ON st.anomalyId = a.id WHERE s.severity = 'HIGH' AND st.status = 'OPEN' AND a.date >= '2023-01-01'"
    repeat: 500

  # --- 4 WHERE conditions (3 JOINs) ---
  - name: "4 cond: severity + status + date + amount (3 JOINs)"
    query: "SELECT a.id, s.severity, st.status, a.date, am.amount FROM AccountAnomalyInv a JOIN AnomalySeverity s ON s.anomalyId = a.id JOIN AnomalyStatus st ON st.anomalyId = a.id JOIN AnomalyAmount am ON am.anomalyId = a.id WHERE s.severity = 'HIGH' AND st.status = 'OPEN' AND a.date >= '2023-01-01' AND am.amount > 50"
    repeat: 500

  # --- Off-index queries (skip the leading severity dimension) ---
  - name: "off-index: status + date (1 JOIN)"
    query: "SELECT a.id, s.severity, st.status, a.date FROM AccountAnomalyInv a JOIN AnomalySeverity s ON s.anomalyId = a.id JOIN AnomalyStatus st ON st.anomalyId = a.id WHERE st.status = 'OPEN' AND a.date >= '2023-01-01'"
    repeat: 500
  - name: "off-index: amount range (1 JOIN)"
    query: "SELECT a.id, s.severity, st.status, a.date, am.amount FROM AccountAnomalyInv a JOIN AnomalySeverity s ON s.anomalyId = a.id JOIN AnomalyStatus st ON st.anomalyId = a.id JOIN AnomalyAmount am ON am.anomalyId = a.id WHERE am.amount > 50"
    repeat: 500
  - name: "off-index: status + amount (2 JOINs)"
    query: "SELECT a.id, s.severity, st.status, a.date, am.amount FROM AccountAnomalyInv a JOIN AnomalySeverity s ON s.anomalyId = a.id JOIN AnomalyStatus st ON st.anomalyId = a.id JOIN AnomalyAmount am ON am.anomalyId = a.id WHERE st.status = 'OPEN' AND am.amount > 50"
    repeat: 500
